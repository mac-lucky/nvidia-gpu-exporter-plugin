<?xml version='1.0' standalone='yes'?>
<!DOCTYPE PLUGIN [
  <!ENTITY name      "nvidia_gpu_exporter">
  <!ENTITY author    "mac-lucky">
  <!ENTITY version   "2025.08.16">
  <!ENTITY launch    "Settings/nvidia_gpu_exporter">
  <!ENTITY gitURL    "https://raw.githubusercontent.com/mac-lucky/nvidia-gpu-exporter-plugin/main">
  <!ENTITY pluginURL "&gitURL;/&name;.plg">
  <!ENTITY md5       "3d69d3b6f4891359469e0980bc85042d">
  <!ENTITY plugin    "/boot/config/plugins/&name;">
  <!ENTITY emhttp    "/usr/local/emhttp/plugins/&name;">
  <!ENTITY packages  "/boot/config/plugins/&name;/packages">
]>

<PLUGIN  name="&name;" author="&author;" version="&version;" launch="&launch;" pluginURL="&pluginURL;" min="6.9.0" support="https://github.com/mac-lucky/nvidia-gpu-exporter-plugin">

<CHANGES>
###2025.08.16
- Initial release
- Based on nvidia_gpu_exporter by utkuozdemir
- Provides Prometheus metrics for NVIDIA GPUs
- Simple start/stop/restart controls
</CHANGES>

<!-- The 'source' file. -->
<FILE Name="/boot/config/plugins/&name;/&name;.txz" Run="upgradepkg --install-new">
<URL>&gitURL;/packages/&name;.txz</URL>
<MD5>&md5;</MD5>
</FILE>

<!-- The 'post-install' script -->
<FILE Name="/tmp/&name;-install" Run="/bin/bash">
<INLINE>
echo "NVIDIA GPU Exporter plugin installed successfully"
</INLINE>
</FILE>

<!-- The 'remove' script. -->
<FILE Name="/tmp/&name;-uninstall" Run="/bin/bash" Method="remove">
<INLINE>
echo "NVIDIA GPU Exporter plugin uninstalled"
</INLINE>
</FILE>

</PLUGIN>
